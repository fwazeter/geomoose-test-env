function OSMGeocoder(e,t){this.title=t.title?t.title:"Search address",this.resultsTitle=t.resultsTitle?t.resultsTitle:"Address search results",this.tools={},this.fields=[{name:"address",type:"text",label:"Address"}],this.targetLayer=t.targetLayer?t.targetLayer:"results/results",this.mapProjection=t.mapProjection?t.mapProjection:"EPSG:3857",this.template='<div class="search-result"><a onClick="app.zoomTo({{ properties.lon }}, {{ properties.lat }}, 18)" class="zoomto-link"><i class="fa fa-search"></i>{{ properties.display_name }}</a></div>',this.resultsAsHtml=function(t,s){return""+e.renderFeaturesWithTemplate(s,"geocoder",this.template)},this.runQuery=function(t,s){var r=this.targetLayer,a=this.mapProjection;gm3.util.xhr({url:"https://nominatim.openstreetmap.org/search/",type:"json",data:{format:"json",q:s.fields[0].value},success:function(s){for(var i=[],o=0,l=s.length;o<l;o++){var p=s[o];i.push({type:"Feature",geometry:{type:"Point",coordinates:[parseFloat(p.lon),parseFloat(p.lat)]},properties:p})}i=gm3.util.projectFeatures(i,"EPSG:4326",a),e.dispatch({id:t,type:"MAP_QUERY_RESULTS",failed:!1,layer:"geocoder",features:i}),e.dispatch({id:t,type:"MAP_QUERY_FINISHED"}),e.clearFeatures(r),i.length>0&&e.addFeatures(r,i)}})},this.query=function(t,s){e.dispatchQuery(this.name,t,s,["geocoder"])}}"undefined"!=typeof module&&(module.exports=OSMGeocoder);